Trabalho 2: Otimização do Desempenho para Sistemas Lineares Esparsos com Pré-condicionantes

O objetivo deste trabalho é melhorar e avaliar o desempenho do programa computacional desenvolvido no 1º Trabalho Prático.

Melhoria de Desempenho

Você deve alterar o código do primeiro trabalho (v1) de forma a obter uma melhora no desempenho (v2) em duas partes:

    Na operação de iteração do método de Gradiente Conjugado com Pré-condicionador de Jacobi (op1);
    Na operação de cálculo do resíduo (op2): R = b - Ax;

As alterações devem ser explicadas no relatório a ser entregue, justificando as razões pelas quais você efetuou cada alteração.

MUITO IMPORTANTE:

    Você deve explicar por que motivo suas modificações levaram a um aumento de desempenho;
    Na versão v2 a estrutura de dados deve ser de tal de forma que nenhuma diagonal nula da matriz de coeficientes é representada em memória, isto é, você deve representar APENAS as diagonais não nulas.

Estimativa de Desempenho

Uma vez alterado o código, você deve responder as seguintes perguntas, justificando suas respostas. Para tal considere uma máquina com 8GB de memória RAM disponível para seu programa e Sistemas com 7 (sete) diagonais (k=7):

    Qual o valor máximo estimado da ordem N do sistema linear que você seria capaz de resolver ?
    Qual o ganho estimado de tempo para uma iteração do método de Gradiente Conjugado com Pré-condicionador de Jacobi (em função de N) ?
    Qual a estimativa para a quantidade de operações em ponto flutuante executadas em cada iteração do método de Gradiente Conjugado com Pré-condicionador de Jacobi (em função de N) ?
    Compare suas estimativas acima com os resultados obtidos nos testes abaixo.

 
Análise de Desempenho

Uma vez alterado o código, você deve comparar o desempenho das duas versões. Estas análises devem ser descritas sob a forma de um trabalho acadêmico, e entregues em forma impressa e em formato PDF.

É imprescindível que sejam respeitadas as seguintes condições:

    Ambos códigos devem ser compilados com GCC e as opções:
          -O3   -march=native  -mavx   -fopt-info-vec;
    Os códigos devem ser compilados na mesma máquina utilizada para os testes.
    Os testes devem utilizar os mesmos parâmetros e em igualdade de condições;
    Ambos códigos devem ser instrumentados com a biblioteca do LIKWID para que se possa separar o cálculo da op1 do cálculo da op2, ou seja, você deve criar um marcador LIKWID para a parte da op1 e outro para a parte da op2;
    Você pode escolher um computador de sua preferência, desde que possua os contadores LIKWID especificados. Não utilize as servidoras de processamento do DInf que tenham uso compartilhado. Elas podem ser máquinas virtuais e o compartilhamento impede medidas de desempenho. Em caso de dúvida, consulte o professor.
    Você deve apresentar a arquitetura do processador utilizado nos testes no seu texto. Estas informações podem ser obtidas com o comando "LIKWID-topology -g -c".

 

Para comparar o desempenho dos códigos, você deve efetuar uma série de testes.

    Cada teste deve ser reportado sob a forma de um gráfico de linhas, com linhas em cores distintas para os resultados de cada versão (v1 e v2) em cada uma das operações (op1 e op2), isto é,  um gráfico para cada operação, contendo curvas com a medida das duas versões em cada operação;
    No eixo das abcissas os gráficos representam o tamanho do Sistema Linear (N). Cada teste deve ser executado para os seguintes tamanhos de matriz:  N={32, 64, 128, 256, 512, 1000, 2000, 4000, 8000, 9000, 10000, 20000};
    Os gráficos devem ser apresentados com o eixo das abscissas (N) em escala logarítmica.
    O número máximo de iterações em todos os testes, para todos tamanhos de matrizes, deve ser 25 (vinte e cinco). Em sua implementação do método de Gradiente Conjugado, deixe a condição de parada dependente apenas da quantidade de iterações;
    O número de diagonais em todos os testes, para todos os tamanhos de matrizes, deve ser 7 (sete, k=7);
    Cada gráfico deve ser explicado e você deve demonstrar que consegue entender o que está reportado nele;

 Os seguintes testes devem ser executados (um gráfico para cada operação):

    Tempo de execução: mostra o tempo médio do cálculo da op1 e o tempo do cálculo da op2 , ambos em ms (utilize a função "timestamp()" da biblioteca utils para medir o tempo).
    Neste gráfico, o eixo das ordenadas (tempo) deve também estar em escala logarítmica;
    Banda de Memória: utilizar o grupo MEM do LIKWID, e apresentar o resultado de "Memory bandwidth [MBytes/s]"; Caso não tenha o grupo MEM, utilize o grupo L3.
    Cache miss L2: utilizar o grupo L2CACHE do LIKWID, e apresentar o resultado de "data cache miss ratio". Caso não tenha o cache miss da L2, utilize o cache miss da L1 (grupo L1CACHE ou CACHE do LIKWID).
    Operações aritméticas: utilizar o grupo FLOPS_DP e FLOPS_AVX do LIKWID, e apresentar o resultado de "MFLOP/s".

 
Produto a ser Entregue

O trabalho deve ser desenvolvido pelo MESMO GRUPO do Trabalho 1.

Cada grupo deve entregar um pacote de software completo contendo os fontes em linguagem C do trabalho 1 (v1), com as modificações introduzidas para o trabalho 2 (v2) e um relatório em formato PDF.

O pacote deve ser arquivado e compactado com tar(1) e gzip(1) em um arquivo chamado login1.tar.gz (se grupo com 1 membro) ou login1-login2.tar.gz (se grupo com 2 membros), onde login1 e login2 são os logins dos alunos que compõem o grupo. O pacote deve ter a mesma estrutura de diretório e arquivos do Trabalho 1.

O arquivo contendo o relatório deve ser nomeado RELATORIO-login1-login2.pdf .

O relatório deve ter o formato de um trabalho acadêmico e conter todas as informações e análises solicitadas. Além disso, a conclusão deve apresentar os aspectos que sua equipe considerou mais relevante/importante no desenvolvimento e nos resultados do trabalho.

Entrega

O prazo final para a entrega deste trabalho é dia  06 de dezembro de 2025, 23:59:00h, IMPRETERIVELMENTE.

    O trabalho deve ser entregue via moodle
    No Relatório DEVE CONSTAR OBRIGATORIAMENTE o Nome e Números de Registro Acadêmico (RA) dos membros do grupo;

 
Avaliação

APENAS OS TRABALHOS QUE FUNCIONAREM SERÃO CORRIGIDOS. Se o trabalho não compilar ou acusar falha de segmentação (Segmentation fault) prematura durante os testes realizados pelo professor (sem que qualquer operação se efetue a contento) ou não produzir uma solução correta para o sistema linear, trará para o grupo NOTA 0 (ZERO). Também receberão NOTA 0 (ZERO) trabalhos plagiados de qualquer fonte, e/ou com códigos idênticos ou similares. Além disso, apenas trabalhos entregues no prazo marcado receberão nota.

Os itens de avaliação do trabalho e respectivas pontuações são:

    Qualidade da documentação: arquivo RELATORIO-login1-login2.pdf (20 pontos)
    Testes: corretude das respostas nos testes executados bem como na sua análise (40 pontos)
    Otimização: Qualidade/dificuldade das otimizações efetuadas (40 pontos)
    BONUS: se você comprovar que está usando os registradores AVX de maneira eficiente no seu código, ganha um bônus de 10 pontos no trabalho.

     
